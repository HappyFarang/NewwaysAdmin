@* File: NewwaysAdmin.WebAdmin/Components/Pages/Workers/Components/ColumnToggleButtons.razor *@
@* Purpose: Toggle buttons for showing/hiding weekly table columns *@
@using NewwaysAdmin.WebAdmin.Models.Workers

<div class="card-header bg-light border-bottom">
    <div class="d-flex align-items-center">
        <h6 class="mb-0 text-muted me-3 flex-shrink-0">
            <span class="bi bi-toggles me-2"></span>
            Show/Hide Columns
        </h6>
        <div class="flex-grow-1 d-flex justify-content-center">
            <div class="btn-toolbar flex-wrap" role="toolbar" style="gap: 0.25rem;">
                <div class="btn-group btn-group-sm" role="group" aria-label="Time columns">
                    <button type="button"
                            class="btn btn-sm @(ColumnVisibility.NormalSignIn ? "btn-primary" : "btn-outline-secondary")"
                            @onclick="() => ToggleColumn(nameof(ColumnVisibility.NormalSignIn))"
                            style="font-size: 0.75rem; padding: 0.125rem 0.25rem;">
                        Normal In
                    </button>
                    <button type="button"
                            class="btn btn-sm @(ColumnVisibility.NormalSignOut ? "btn-primary" : "btn-outline-secondary")"
                            @onclick="() => ToggleColumn(nameof(ColumnVisibility.NormalSignOut))"
                            style="font-size: 0.75rem; padding: 0.125rem 0.25rem;">
                        Normal Out
                    </button>
                    <button type="button"
                            class="btn btn-sm @(ColumnVisibility.OTSignIn ? "btn-warning" : "btn-outline-secondary")"
                            @onclick="() => ToggleColumn(nameof(ColumnVisibility.OTSignIn))"
                            style="font-size: 0.75rem; padding: 0.125rem 0.25rem;">
                        OT In
                    </button>
                    <button type="button"
                            class="btn btn-sm @(ColumnVisibility.OTSignOut ? "btn-warning" : "btn-outline-secondary")"
                            @onclick="() => ToggleColumn(nameof(ColumnVisibility.OTSignOut))"
                            style="font-size: 0.75rem; padding: 0.125rem 0.25rem;">
                        OT Out
                    </button>
                </div>

                <div class="btn-group btn-group-sm" role="group" aria-label="Hour columns">
                    <button type="button"
                            class="btn btn-sm @(ColumnVisibility.WorkHours ? "btn-info" : "btn-outline-secondary")"
                            @onclick="() => ToggleColumn(nameof(ColumnVisibility.WorkHours))"
                            style="font-size: 0.75rem; padding: 0.125rem 0.25rem;">
                        Work Hours
                    </button>
                    <button type="button"
                            class="btn btn-sm @(ColumnVisibility.OTHours ? "btn-info" : "btn-outline-secondary")"
                            @onclick="() => ToggleColumn(nameof(ColumnVisibility.OTHours))"
                            style="font-size: 0.75rem; padding: 0.125rem 0.25rem;">
                        OT Hours
                    </button>
                </div>

                <div class="btn-group btn-group-sm" role="group" aria-label="Status columns">
                    <button type="button"
                            class="btn btn-sm @(ColumnVisibility.Variance ? "btn-success" : "btn-outline-secondary")"
                            @onclick="() => ToggleColumn(nameof(ColumnVisibility.Variance))"
                            style="font-size: 0.75rem; padding: 0.125rem 0.25rem;">
                        Variance
                    </button>
                    <button type="button"
                            class="btn btn-sm @(ColumnVisibility.OnTime ? "btn-success" : "btn-outline-secondary")"
                            @onclick="() => ToggleColumn(nameof(ColumnVisibility.OnTime))"
                            style="font-size: 0.75rem; padding: 0.125rem 0.25rem;">
                        On Time
                    </button>
                    <button type="button"
                            class="btn btn-sm @(ColumnVisibility.DailyPay ? "btn-dark" : "btn-outline-secondary")"
                            @onclick="() => ToggleColumn(nameof(ColumnVisibility.DailyPay))"
                            style="font-size: 0.75rem; padding: 0.125rem 0.25rem;">
                        Daily Pay
                    </button>
                </div>

                <!-- Pay Breakdown Columns -->
                <div class="btn-group btn-group-sm" role="group" aria-label="Pay breakdown columns">
                    <button type="button"
                            class="btn btn-sm @(ColumnVisibility.NormalPay ? "btn-success" : "btn-outline-secondary")"
                            @onclick="() => ToggleColumn(nameof(ColumnVisibility.NormalPay))"
                            title="Show Normal Pay breakdown"
                            style="font-size: 0.75rem; padding: 0.125rem 0.25rem;">
                        💰Normal Pay
                    </button>
                    <button type="button"
                            class="btn btn-sm @(ColumnVisibility.OTPay ? "btn-warning" : "btn-outline-secondary")"
                            @onclick="() => ToggleColumn(nameof(ColumnVisibility.OTPay))"
                            title="Show OT Pay breakdown"
                            style="font-size: 0.75rem; padding: 0.125rem 0.25rem;">
                        ⏰OT Pay
                    </button>
                </div>
            </div> <!-- Close btn-toolbar -->
        </div> <!-- Close flex-grow-1 -->
    </div> <!-- Close d-flex -->
</div> <!-- Close card-header -->
@code {
    [Parameter]
    public WeeklyTableColumnVisibility ColumnVisibility { get; set; } = new();

    [Parameter]
    public EventCallback<WeeklyTableColumnVisibility> OnColumnVisibilityChanged { get; set; }

    private async Task ToggleColumn(string columnName)
    {
        var property = typeof(WeeklyTableColumnVisibility).GetProperty(columnName);
        if (property != null && property.PropertyType == typeof(bool))
        {
            var currentValue = (bool)property.GetValue(ColumnVisibility)!;
            property.SetValue(ColumnVisibility, !currentValue);

            await OnColumnVisibilityChanged.InvokeAsync(ColumnVisibility);
        }
    }
}