@* File: NewwaysAdmin.WebAdmin/Components/Features/Accounting/BankSlipProjects/Modals/ImageViewerModal.razor *@

@if (isVisible)
{
    <div class="modal fade show d-block" tabindex="-1" style="background-color: rgba(0,0,0,0.9);" @onclick="Close">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content bg-dark" @onclick:stopPropagation="true">
                <div class="modal-header border-0">
                    <h5 class="modal-title text-white">
                        <i class="bi bi-image me-2"></i>@fileName
                    </h5>
                    <button type="button" class="btn-close btn-close-white" @onclick="Close"></button>
                </div>

                <div class="modal-body text-center p-2">
                    @if (!string.IsNullOrEmpty(imageUrl))
                    {
                        <img src="@imageUrl" class="img-fluid" style="max-height: 80vh;" alt="Bank Slip" />
                    }
                    else
                    {
                        <div class="text-white py-5">
                            <i class="bi bi-exclamation-triangle display-4"></i>
                            <p class="mt-3">Image could not be loaded</p>
                        </div>
                    }
                </div>

                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-secondary" @onclick="Close">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>
}

@code {
    private bool isVisible = false;
    private string? imageUrl;
    private string fileName = "";

    public Task OpenAsync(string projectId, string? imageUrlOrPath)
    {
        fileName = projectId;

        // TODO: Convert .bin file path to viewable image URL
        // For now, this is a placeholder
        imageUrl = imageUrlOrPath;

        isVisible = true;
        StateHasChanged();

        return Task.CompletedTask;
    }

    private void Close()
    {
        isVisible = false;
        imageUrl = null;
        StateHasChanged();
    }
}
