@* COMPLETE REPLACEMENT FOR SpatialOcrAnalyzer.razor *@
@* Replace your entire 977-line file with this clean version *@
@using Microsoft.AspNetCore.Components.Forms
@using NewwaysAdmin.SharedModels.Models.Ocr.Core
@using NewwaysAdmin.WebAdmin.Components.Features.Settings.OcrAnalyzer.SpatialOcrAnalyzer
@using NewwaysAdmin.WebAdmin.Components.Features.Settings.OcrAnalyzer.SpatialOcrAnalyzer.Components
@using NewwaysAdmin.WebAdmin.Components.Features.Settings.OcrAnalyzer.SpatialOcrAnalyzer.Views
@inject ISpatialOcrService SpatialOcrService
@implements IDisposable

<div class="spatial-ocr-container">
    <!-- Header Section -->
    <div class="header-section">
        <h2><i class="bi bi-eye"></i> Spatial OCR Analyzer</h2>
        <p class="subtitle">Test spatial OCR extraction with word positioning and pattern testing</p>
    </div>

    <!-- File Upload Panel -->
    <FileUploadPanel State="@state" />

    <!-- Results Section (only show when we have results) -->
    @if (state.SpatialResult?.Success == true && state.SpatialResult.Document != null)
    {
        <div class="results-section">
            <!-- View Navigation Tabs -->
            <ViewTabsContainer State="@state" />

            <!-- Content Display Based on Active View -->
            <div class="content-display">
                @switch (state.ActiveView)
                {
                    case "heatmap":
                        <HeatMapView State="@state" />
                        break;
                    case "text":
                        <TextView State="@state" />
                        break;
                    case "spatial":
                        <DataView State="@state" />
                        break;
                    case "debug":
                        <DebugView State="@state" />
                        break;
                    case "patterns":
                        <PatternView State="@state" />
                        break;
                    default:
                        <HeatMapView State="@state" />
                        break;
                }
            </div>
        </div>

        <!-- Summary Cards -->
        <SummaryCards State="@state" />
    }
</div>

@code {
    private SpatialOcrAnalyzerState state = new();

    protected override void OnInitialized()
    {
        // Subscribe to state changes
        state.StateChanged += StateHasChanged;
    }

    public void Dispose()
    {
        // Clean up event subscription
        state.StateChanged -= StateHasChanged;
    }
}