<?xml version="1.0" encoding="utf-8" ?>
<!-- File: Mobile/NewwaysAdmin.Mobile/Pages/SettingsPage.xaml -->
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="NewwaysAdmin.Mobile.Pages.SettingsPage"
             Title="Settings">

    <ScrollView>
        <StackLayout Padding="20" Spacing="15">

            <!-- Header -->
            <Label Text="⚙️ Settings" 
                   FontSize="24" 
                   FontAttributes="Bold" 
                   HorizontalOptions="Center"
                   Margin="0,10,0,20"/>

            <!-- Back Button -->
            <Button Text="← Back to Categories"
                    Clicked="OnBackClicked"
                    BackgroundColor="#1976D2"
                    TextColor="White"
                    FontSize="16"
                    HeightRequest="50"
                    CornerRadius="10"
                    Margin="0,0,0,10"/>

            <BoxView HeightRequest="1" Color="LightGray" />

            <!-- User Info Section -->
            <Frame BackgroundColor="#F5F5F5" 
                   Padding="15" 
                   CornerRadius="10">
                <StackLayout Spacing="5">
                    <Label Text="Account" 
                           FontSize="12" 
                           TextColor="Gray"/>
                    <Label x:Name="UsernameLabel" 
                           Text="Loading..." 
                           FontSize="18" 
                           FontAttributes="Bold"/>
                    <Label x:Name="ServerLabel" 
                           Text="" 
                           FontSize="12" 
                           TextColor="Gray"/>
                </StackLayout>
            </Frame>

            <!-- App Info Section -->
            <Frame BackgroundColor="#F5F5F5" 
                   Padding="15" 
                   CornerRadius="10">
                <StackLayout Spacing="5">
                    <Label Text="App Version" 
                           FontSize="12" 
                           TextColor="Gray"/>
                    <Label Text="1.0.0" 
                           FontSize="16"/>
                </StackLayout>
            </Frame>

            <BoxView HeightRequest="1" Color="LightGray" Margin="0,10" />

            <!-- ========== BANK SLIP AUTO-SYNC SECTION ========== -->
            <Label Text="📸 Bank Slip Auto-Sync" 
                   FontSize="20" 
                   FontAttributes="Bold"
                   Margin="0,10,0,5"/>

            <!-- Enable/Disable Toggle -->
            <Frame BackgroundColor="#F5F5F5" 
                   Padding="15" 
                   CornerRadius="10">
                <Grid ColumnDefinitions="*,Auto">
                    <StackLayout Grid.Column="0" VerticalOptions="Center">
                        <Label Text="Auto-sync enabled" 
                               FontSize="16"/>
                        <Label Text="Automatically upload new bank slip screenshots" 
                               FontSize="12" 
                               TextColor="Gray"/>
                    </StackLayout>
                    <Switch x:Name="EnabledSwitch" 
                            Grid.Column="1"
                            VerticalOptions="Center"
                            Toggled="OnEnabledToggled"/>
                </Grid>
            </Frame>

            <!-- Monitored Folders Section -->
            <Frame BackgroundColor="#F5F5F5" 
                   Padding="15" 
                   CornerRadius="10">
                <StackLayout Spacing="10">
                    <Label Text="Monitored Folders" 
                           FontSize="16" 
                           FontAttributes="Bold"/>
                    <Label Text="Select a folder and give it a pattern name for OCR" 
                           FontSize="12" 
                           TextColor="Gray"/>

                    <!-- Add folder section -->
                    <Frame BackgroundColor="White" Padding="10" CornerRadius="5">
                        <StackLayout Spacing="8">

                            <!-- Browse button + selected path display -->
                            <Grid ColumnDefinitions="Auto,*" ColumnSpacing="10">
                                <Button x:Name="BrowseFolderButton"
                                        Grid.Column="0"
                                        Text="📁 Browse"
                                        Clicked="OnBrowseFolderClicked"
                                        BackgroundColor="#2196F3"
                                        TextColor="White"
                                        FontSize="14"
                                        HeightRequest="40"
                                        CornerRadius="5"/>
                                <Label x:Name="SelectedFolderLabel"
                                       Grid.Column="1"
                                       Text="No folder selected"
                                       FontSize="12"
                                       TextColor="Gray"
                                       VerticalOptions="Center"
                                       LineBreakMode="TailTruncation"/>
                            </Grid>

                            <!-- Pattern name entry -->
                            <Grid ColumnDefinitions="Auto,*" ColumnSpacing="10">
                                <Label Grid.Column="0"
                                       Text="Pattern:"
                                       FontSize="14"
                                       VerticalOptions="Center"/>
                                <Entry x:Name="PatternNameEntry"
                                       Grid.Column="1"
                                       Placeholder="e.g., KPLUS_Thomas"
                                       FontSize="14"/>
                            </Grid>

                            <!-- Add button -->
                            <Button x:Name="AddFolderButton"
                                    Text="+ Add Folder"
                                    Clicked="OnAddFolderClicked"
                                    BackgroundColor="#4CAF50"
                                    TextColor="White"
                                    FontSize="14"
                                    HeightRequest="40"
                                    CornerRadius="5"/>
                        </StackLayout>
                    </Frame>

                    <!-- Folder list -->
                    <StackLayout x:Name="FolderListContainer" Spacing="5">
                        <!-- Folders will be added here dynamically -->
                        <Label x:Name="NoFoldersLabel" 
                               Text="No folders configured" 
                               FontSize="14" 
                               TextColor="Gray"
                               HorizontalOptions="Center"/>
                    </StackLayout>
                </StackLayout>
            </Frame>

            <!-- Sync From Date -->
            <Frame BackgroundColor="#F5F5F5" 
                   Padding="15" 
                   CornerRadius="10">
                <StackLayout Spacing="5">
                    <Label Text="Sync images from" 
                           FontSize="16"/>
                    <Label Text="Only upload images newer than this date" 
                           FontSize="12" 
                           TextColor="Gray"/>
                    <DatePicker x:Name="SyncFromDatePicker"
                                DateSelected="OnSyncFromDateChanged"
                                Format="yyyy-MM-dd"/>
                </StackLayout>
            </Frame>

            <!-- Manual Scan Button -->
            <Button x:Name="ScanNowButton"
                    Text="🔍 Scan Now"
                    Clicked="OnScanNowClicked"
                    BackgroundColor="#FF9800"
                    TextColor="White"
                    FontSize="16"
                    HeightRequest="50"
                    CornerRadius="10"/>

            <!-- Status Display -->
            <Label x:Name="BankSlipStatusLabel" 
                   Text="" 
                   FontSize="14" 
                   TextColor="#1565C0"
                   HorizontalOptions="Center"
                   Margin="0,5"/>

            <!-- ========== END BANK SLIP SECTION ========== -->

            <BoxView HeightRequest="1" Color="LightGray" Margin="0,10" />

            <!-- Logout Button -->
            <Button Text="🚪 Sign Out"
                    Clicked="OnLogoutClicked"
                    BackgroundColor="#E53935"
                    TextColor="White"
                    FontSize="16"
                    HeightRequest="50"
                    CornerRadius="10"/>

            <!-- Bottom padding -->
            <BoxView HeightRequest="30" Color="Transparent" />

        </StackLayout>
    </ScrollView>

</ContentPage>
