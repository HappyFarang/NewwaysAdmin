<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:NewwaysAdmin.Mobile.ViewModels"
             xmlns:models="clr-namespace:NewwaysAdmin.SharedModels.Categories;assembly=NewwaysAdmin.SharedModels"
             x:Class="NewwaysAdmin.Mobile.Pages.SubCategoryListPage"
             x:DataType="viewmodels:SubCategoryListViewModel"
             Title="{Binding CategoryName}">

    <Grid RowDefinitions="Auto,*,Auto">

        <!-- Header Info -->
        <Frame Grid.Row="0"
               BackgroundColor="{StaticResource Primary}"
               Padding="15"
               Margin="0"
               CornerRadius="0">
            <VerticalStackLayout Spacing="5">
                <Label Text="{Binding CategoryName}"
                       TextColor="White"
                       FontSize="24"
                       FontAttributes="Bold"/>
                <Label Text="{Binding LocationName, StringFormat='Location: {0}'}"
                       TextColor="White"
                       FontSize="14"
                       Opacity="0.8"/>
                <Label Text="Tap any subcategory to copy to clipboard"
                       TextColor="White"
                       FontSize="12"
                       Opacity="0.7"
                       Margin="0,10,0,0"/>
            </VerticalStackLayout>
        </Frame>

        <!-- SubCategory List -->
        <CollectionView Grid.Row="1"
                       ItemsSource="{Binding SubCategories}"
                       Margin="10">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:MobileSubCategoryItem">
                    <Frame Margin="0,5"
                           Padding="15"
                           BackgroundColor="{StaticResource Secondary}"
                           CornerRadius="10"
                           HasShadow="True">
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:SubCategoryListViewModel}}, Path=CopyToClipboardCommand}"
                                                 CommandParameter="{Binding .}"/>
                        </Frame.GestureRecognizers>
                        <HorizontalStackLayout Spacing="15">
                            <Label Text="ðŸ“‹"
                                   FontSize="28"
                                   VerticalOptions="Center"/>
                            <VerticalStackLayout Spacing="5"
                                                VerticalOptions="Center"
                                                HorizontalOptions="FillAndExpand">
                                <Label Text="{Binding Name}"
                                       FontSize="18"
                                       FontAttributes="Bold"
                                       TextColor="White"/>
                                <Label Text="{Binding FullPath}"
                                       FontSize="12"
                                       TextColor="White"
                                       Opacity="0.7"/>
                            </VerticalStackLayout>
                            <Label Text="ðŸ“„"
                                   FontSize="24"
                                   TextColor="White"
                                   VerticalOptions="Center"
                                   Opacity="0.6"/>
                        </HorizontalStackLayout>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- Last Copied Display -->
        <Frame Grid.Row="2"
               BackgroundColor="{StaticResource Tertiary}"
               Padding="15"
               Margin="0"
               CornerRadius="0"
               IsVisible="{Binding LastCopiedText, Converter={StaticResource StringNotEmptyConverter}}">
            <HorizontalStackLayout Spacing="10">
                <Label Text="âœ“"
                       FontSize="18"
                       TextColor="Green"
                       VerticalOptions="Center"/>
                <VerticalStackLayout Spacing="2"
                                    HorizontalOptions="FillAndExpand">
                    <Label Text="Last copied:"
                           FontSize="12"
                           Opacity="0.7"/>
                    <Label Text="{Binding LastCopiedText}"
                           FontSize="14"
                           FontAttributes="Bold"/>
                </VerticalStackLayout>
            </HorizontalStackLayout>
        </Frame>

    </Grid>

</ContentPage>
